{{- if eq .chezmoi.os "darwin" -}}
#!/bin/bash

set -e

command_exists() {
  command -v "$@" >/dev/null 2>&1
}

main() {
  echo "ğŸš€ Installing development tools for macOS..."

  # Volta
  echo ""
  echo "ğŸ“¦ Installing Volta..."
  if ! command_exists volta; then
    echo "Installing Volta Node.js manager..."
    curl https://get.volta.sh | bash -s -- --skip-setup

    # ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§Voltaã‚’æœ‰åŠ¹åŒ–
    export VOLTA_HOME="$HOME/.volta"
    export PATH="$VOLTA_HOME/bin:$PATH"

    echo "âœ… Volta installed successfully"
  else
    echo "âœ… Volta already installed, skipping"
  fi

  # Node.JS
  echo ""
  echo "ğŸ“¦ Installing Node.js tools..."
  if command_exists volta; then
    echo "Installing Node.js via Volta..."
    volta install node@lts
    volta install npm@latest
    volta install yarn@latest
    echo "âœ… Node.js tools installed successfully"
  else
    echo "âŒ volta command not found, skipping Node.js installation"
  fi

  # Docker Desktop for macOS
  echo ""
  echo "ğŸ³ Installing Docker Desktop..."
  if ! command_exists docker; then
    echo "Installing Docker Desktop for macOS..."

    # HomebrewçµŒç”±ã§Docker Desktopã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
    if command_exists brew; then
      brew install --cask docker
      echo "âœ… Docker Desktop installed successfully"
      echo "âš ï¸  Please start Docker Desktop from Applications folder"
    else
      echo "âŒ Homebrew not found. Please install Homebrew first or download Docker Desktop manually"
      echo "   Download from: https://docs.docker.com/desktop/install/mac-install/"
    fi
  else
    echo "âœ… Docker already installed, skipping"
  fi

  # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
  echo ""
  echo "ğŸ‰ Installation completed!"
  echo "Installed tools:"
  command_exists volta && echo "  âœ… Volta"
  command_exists node && echo "  âœ… Node.js $(node --version)"
  command_exists npm && echo "  âœ… npm $(npm --version)"
  command_exists yarn && echo "  âœ… Yarn $(yarn --version)"
  command_exists docker && echo "  âœ… Docker $(docker --version)"
}

main "$@"

{{- end -}}
